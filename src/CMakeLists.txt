SET(CMAKE_INCLUDE_CURRENT_DIR ON)
INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/.. ${CMAKE_CURRENT_SOURCE_DIR}/../include ${NEON_INCLUDE_DIR})

FILE(GLOB _sources ${CMAKE_CURRENT_SOURCE_DIR}/*.cc ${CMAKE_CURRENT_SOURCE_DIR}/*.cpp)
ADD_LIBRARY(musicbrainz4 SHARED ${_sources})

SET_TARGET_PROPERTIES(musicbrainz4 PROPERTIES
    VERSION ${musicbrainz4_VERSION}
    SOVERSION ${musicbrainz4_SOVERSION}
    DEFINE_SYMBOL MB_API_EXPORTS
)

TARGET_LINK_LIBRARIES(musicbrainz4 ${NEON_LIBRARIES})

IF(DISCID_FOUND)
    INCLUDE_DIRECTORIES(${DISCID_INCLUDE_DIR})
    TARGET_LINK_LIBRARIES(musicbrainz4 ${DISCID_LIBRARIES})
ENDIF(DISCID_FOUND)

IF(WIN32)
    TARGET_LINK_LIBRARIES(musicbrainz4 wsock32 winmm ws2_32)
ENDIF(WIN32)

INSTALL(TARGETS musicbrainz4 DESTINATION ${LIB_INSTALL_DIR})
